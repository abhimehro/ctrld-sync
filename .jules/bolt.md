## 2025-02-23 - Python Module Patching Flakiness
**Learning:** Patching global variables (like `USE_COLORS`) in a module can fail if previous tests manipulated `sys.modules` (e.g., `del sys.modules['main']`) or used `sys.path.append` to re-import the module from a different path. This results in the test holding a reference to an old module object while `patch` modifies the new one.
**Action:** Avoid `sys.path.append` in tests if possible. Use `patch.object(module, 'var', val)` instead of `patch('module.var', val)` where `module` is imported inside the test function to ensure it targets the current `sys.modules` entry.
